# Difference in average revenue by calls over time
avg_revenue_call_min = avg_revenue_weekly_sales.loc[(avg_revenue_weekly_sales['sales_method'] == 'Call')]['mean'].min()
avg_revenue_call_max = avg_revenue_weekly_sales.loc[(avg_revenue_weekly_sales['sales_method'] == 'Call')]['mean'].max()
avg_revenue_call_diff = round((avg_revenue_call_max - avg_revenue_call_min), 2)
avg_revenue_call_percent = round((avg_revenue_call_diff / avg_revenue_call_min) * 100, 2)

# Difference in average revenue by emails over time
avg_revenue_email_min = avg_revenue_weekly_sales.loc[(avg_revenue_weekly_sales['sales_method'] == 'Email')]['mean'].min()
avg_revenue_email_max = avg_revenue_weekly_sales.loc[(avg_revenue_weekly_sales['sales_method'] == 'Email')]['mean'].max()
avg_revenue_email_diff = round((avg_revenue_email_max - avg_revenue_email_min), 2)
avg_revenue_email_percent = round((avg_revenue_email_diff / avg_revenue_email_min) * 100, 2)

# Difference in average revenue by email + calls over time
avg_revenue_email_call_min = avg_revenue_weekly_sales.loc[(avg_revenue_weekly_sales['sales_method'] == 'Email + Call')]['mean'].min()
avg_revenue_email_call_max = avg_revenue_weekly_sales.loc[(avg_revenue_weekly_sales['sales_method'] == 'Email + Call')]['mean'].max()
avg_revenue_email_call_diff = round((avg_revenue_email_call_max - avg_revenue_email_call_min), 2)
avg_revenue_email_call_percent = round((avg_revenue_email_call_diff / avg_revenue_email_call_min) * 100, 2)

print(f'The difference in average revenue over time for calls was {avg_revenue_call_diff} ({avg_revenue_call_percent} %), while for emails it was {avg_revenue_email_diff} ({avg_revenue_email_percent} %), and for emails + calls it was {avg_revenue_email_call_diff} ({avg_revenue_email_call_percent} %.)')

# Percentage of total calls week 1
percent_call_week_1 = avg_revenue_weekly_sales.at[0, 'ratio']
percent_email_call_week_1 = avg_revenue_weekly_sales.at[2, 'ratio']
percent_total_calls_week_1 = percent_call_week_1 + percent_email_call_week_1

# Percentage of total calls week 4
percent_call_week_4 = avg_revenue_weekly_sales.at[9, 'ratio']
percent_email_call_week_4 = avg_revenue_weekly_sales.at[11, 'ratio']
percent_total_calls_week_4 = percent_call_week_4 + percent_email_call_week_4

# Difference in percentage from weeks 1 to 4
total_calls_diff = percent_total_calls_week_4 - percent_total_calls_week_1
percent_calls_diff = round(((total_calls_diff / percent_total_calls_week_1) * 100), 2)

print(f'Total calls in week 1 was {percent_total_calls_week_1}, while in week 4 it was {percent_total_calls_week_4}. Resulting in an absoolute difference of {total_calls_diff} ({percent_calls_diff} %.)')